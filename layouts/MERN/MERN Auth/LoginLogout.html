<!doctype html>
<html lang="en" data-bs-theme="light">

<head>
    <!-- <script src="/assets/js/color-modes.js"></script> -->

    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="../../../../assets/icons/circle-logo.png">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.118.2">
    <title>Digital-Academy</title>

    <!-- Custom style -->
    <link href="/assets/styles/sidebar.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/styles/styles.css">
    <link rel="stylesheet" href="/assets/styles/styles2.css">
    <!-- bootstrap style -->

    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"> -->


    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism.min.css"> -->



    <!-- Include the Prism.js library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>

    <!-- Include the Okaidia theme -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css">


</head>

<body class="single home " data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-root-margin="0px 0px -60%"
    data-bs-smooth-scroll="true" tabindex="0" cz-shortcut-listen="true">
    <div class="sticky-top">
        <header class="navbar navbar-expand-lg g-nav">
            <div class="container-lg"><a class="navbar-brand me-auto me-lg-3" href="#"> <img
                        src="/assets/icons/logo.png" alt="logo" style="width: 70px; height: 50px;">
                </a>
                <a id="home" href="/home.html">HOME</a>
                <button class="btn btn-link d-lg-none" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasNavSection" aria-controls="offcanvasNavSection"
                    aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg"
                        class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"></path>
                        <path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"></path>
                        <path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"></path>
                    </svg></button>
                <div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="offcanvasNavSection"
                    aria-labelledby="offcanvasNavSectionLabel">
                    <div class="offcanvas-header">
                        <img src="/assets/icons/logo.png" alt="logo" style="width: 70px; height: 50px;">
                        <button type="button" class="btn btn-link nav-link p-0" data-bs-dismiss="offcanvas"
                            aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg"
                                class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M18 6 6 18"></path>
                                <path d="M6 6l12 12"></path>
                            </svg></button>
                    </div>
                    <div class="offcanvas-body">
                        <aside class="doks-sidebar mt-n3">
                            <nav id="doks-docs-nav" aria-label="Tertiary navigation">
                                <div class="module pb-2 pt-4">
                                    <h2 class="mod-title">MERN</h2>
                                    <div class="module pb-2">
                                        <a href="../../MERN/Sockets/WebSockets.html" class="previous ">&#8249;</a>
                                        <img src="/assets/icons/default.png" alt="" class="chapter-icon " />
                                        <span class="mod-title">MERN Auth</span>
                                        <a href="../../MERN/Projects/Introduction/Objectives.html"
                                            class="next">&#8250;</a>
                                    </div>
                                </div>
                                <ul class="list-unstyled collapsible-sidebar">


                                    <li class="mb-1">
                                        <button id="sidebtn"
                                            class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed"
                                            data-bs-toggle="collapse" data-bs-target="#MERNAuth-collapse"
                                            aria-expanded="true">
                                            MERN Auth
                                        </button>
                                        <div class="collapse show" id="MERNAuth-collapse">
                                            <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                                                <li><a href="../MERN Auth/Introduction.html" class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Introduction</a>
                                                </li>
                                                <li><a href="../MERN Auth/AuthenticationandAuthorization.html"
                                                        class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Authentication and Authorization</a>
                                                </li>
                                                <li><a href="../MERN Auth/UserModel.html" class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />User Model</a>
                                                </li>
                                                <li><a href="../MERN Auth/Registration.html" class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Registration</a>
                                                </li>
                                                <li><a href="../MERN Auth/EnvironmentVariables.html"
                                                        class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Environment Variables</a>
                                                </li>
                                                <li><a href="../MERN Auth/JSONWebTokens.html"
                                                        class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />JSON Web Tokens</a>
                                                </li>
                                                <li><a href="../MERN Auth/Cookies.html" class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Cookies</a>
                                                </li>
                                                <li><a href="../MERN Auth/asyncawait.html" class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />async/await</a>
                                                </li>
                                                <li><a href="../MERN Auth/LoginLogout.html"
                                                        class="docs-link rounded active">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Login/Logout</a>
                                                </li>
                                                <li><a href="../MERN Auth/AuthorizationandMiddleware.html"
                                                        class="docs-link rounded ">
                                                        <img src="/assets/icons/module.png" alt=""
                                                            class="module-icon" />Authorization and Middleware</a>
                                                </li>








                                            </ul>
                                        </div>
                                    </li>


                                </ul>
                            </nav>
                        </aside>
                    </div>
                </div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type="button"
                    data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavMain" aria-controls="offcanvasNavMain"
                    aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg"
                        class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <line x1="4" y1="8" x2="20" y2="8"></line>
                        <line x1="4" y1="16" x2="20" y2="16"></line>
                    </svg></button>
                <div class="offcanvas offcanvas-end h-auto" tabindex="-1" id="offcanvasNavMain"
                    aria-labelledby="offcanvasNavMainLabel">
                    <div class="offcanvas-header">
                        <img src="/assets/icons/logo.png" alt="logo" style="width: 70px; height: 50px;">
                        <button type="button" class="btn btn-link nav-link p-0" data-bs-dismiss="offcanvas"
                            aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg"
                                class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M18 6 6 18"></path>
                                <path d="M6 6l12 12"></path>
                            </svg></button>
                    </div>
                    <div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between">
                        <!-- <ul class="navbar-nav flex-grow-1">
              <li class="nav-item"><a class="nav-link active" href="index.html" aria-current="true">Docs</a></li>
              <li class="nav-item"><a class="nav-link" href="/blog/">Blog</a></li>
            </ul> -->

                        <!-- this section is for the search bar and results -->
                        <form class="navbar-form my-auto flex-grow-1 ">
                            <input id="searchInput" class="form-control is-search ms-auto me-5" type="search"
                                placeholder="Search ." aria-label="Search docs." autocomplete="off">
                            <div id="suggestions" class="shadow rounded position-absolute d-none">
                                <ul id="searchResults" class="list-unstyled m-auto"></ul>
                            </div>
                        </form>


                        <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1"
                            type="button" aria-label="Toggle theme"><svg data-bs-theme-value="dark"
                                xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24"
                                height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"></path>
                            </svg><svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg"
                                class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24"
                                stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path
                                    d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7">
                                </path>
                            </svg></button>
                        <ul id="socialMenu" class="nav mx-auto flex-row order-lg-4">


                            <li class="nav-item"><a class="nav-link social-link"
                                    href="https://github.com/DigitalAcademyTn"><svg xmlns="http://www.w3.org/2000/svg"
                                        class="icon icon-tabler icon-tabler-brand-github" width="24" height="24"
                                        viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <path
                                            d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21">
                                        </path>
                                    </svg><small class="ms-2 visually-hidden">GitHub</small></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </header>
    </div>




    <div class="wrap container-fluid " role="document">
        <div class="content">
            <div class="row  d-flex justify-content-center">
                <div class=" docs-sidebar d-none d-lg-block   ">
                    <main class="">
                        <div class="flex-shrink-0 pt-4 ">

                            <div class="module pb-2">
                                <h2 class="mod-title">MERN</h2>
                            </div>
                            <div class="module pb-2">
                                <a href="../../MERN/Sockets/WebSockets.html" class="previous ">&#8249;</a>
                                <img src="/assets/icons/default.png" alt="" class="chapter-icon " />
                                <span class="mod-title">MERN Auth</span>
                                <a href="../../MERN/Projects/Introduction/Objectives.html" class="next">&#8250;</a>
                            </div>





                            <ul class=" list-unstyled px-3 overflow-scroll">


                                <li class="mb-1">
                                    <button id="sidebtn"
                                        class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed"
                                        data-bs-toggle="collapse" data-bs-target="#MERNAuth-collapse"
                                        aria-expanded="true">
                                        MERN Auth
                                    </button>
                                    <div class="collapse show" id="MERNAuth-collapse">
                                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                                            <li><a href="../MERN Auth/Introduction.html" class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Introduction</a>
                                            </li>
                                            <li><a href="../MERN Auth/AuthenticationandAuthorization.html"
                                                    class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Authentication and Authorization</a>
                                            </li>
                                            <li><a href="../MERN Auth/UserModel.html" class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />User Model</a>
                                            </li>
                                            <li><a href="../MERN Auth/Registration.html" class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Registration</a>
                                            </li>
                                            <li><a href="../MERN Auth/EnvironmentVariables.html"
                                                    class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Environment Variables</a>
                                            </li>
                                            <li><a href="../MERN Auth/JSONWebTokens.html" class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />JSON Web Tokens</a>
                                            </li>
                                            <li><a href="../MERN Auth/Cookies.html" class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Cookies</a>
                                            </li>
                                            <li><a href="../MERN Auth/asyncawait.html" class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />async/await</a>
                                            </li>
                                            <li><a href="../MERN Auth/LoginLogout.html"
                                                    class="docs-link rounded active">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Login/Logout</a>
                                            </li>
                                            <li><a href="../MERN Auth/AuthorizationandMiddleware.html"
                                                    class="docs-link rounded ">
                                                    <img src="/assets/icons/module.png" alt=""
                                                        class="module-icon" />Authorization and Middleware</a>
                                            </li>








                                        </ul>
                                    </div>
                                </li>

                            </ul>
                        </div>

                    </main>

                </div>
                <div class="docs-content col-lg-11 col-xl-9 " id="lesson_content">

                    <main data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="0" tabindex="0">
                        <div id="lesson_content">
                            <h1 class="text-center">Login/Logout</h1>
                            <p>When logging in to our project, the steps are as follows:</p>
                            <ol>
                                <li>Have a user input information in a form.</li>
                                <li>Once the form is submitted, we will send a request to our server with the
                                    information.</li>
                                <li>On the server-side, we will need to check and make sure that the user's credentials
                                    are correct.</li>
                                <li>If they are, we will create a JWT and send it back in the form of a cookie.</li>
                            </ol>
                            <p>In code, it will look like this:</p>
                            <div class="highlight">
                                <div class="clipboard"><button class="btn btn-clipboard blankkk"
                                        aria-label="Clipboard button"></button></div>
<pre data-language="javascript">login: <span class="function call">async</span>(req, res) <span class="storage type function arrow">=&gt;</span> {
    <span class="storage type">const</span> user <span class="keyword operator">=</span> await User.<span class="function call">findOne</span>({ email: req.body.email });
    
    <span class="entity name function">if</span>(user <span class="keyword operator">=</span><span class="keyword operator">=</span><span class="keyword operator">=</span> <span class="constant language">null</span>) {
        <span class="comment">// email not found in users collection</span>
        <span class="keyword">return</span> res.<span class="function call">sendStatus</span>(<span class="constant numeric">400</span>);
    }
    
    <span class="comment">// if we made it this far, we found a user with this email address</span>
    <span class="comment">// let's compare the supplied password to the hashed password in the database</span>
    <span class="storage type">const</span> correctPassword <span class="keyword operator">=</span> await bcrypt.<span class="function call">compare</span>(req.body.password, user.password);
    
    <span class="entity name function">if</span>(<span class="keyword operator">!</span>correctPassword) {
        <span class="comment">// password wasn't a match!</span>
        <span class="keyword">return</span> res.<span class="function call">sendStatus</span>(<span class="constant numeric">400</span>);
    }
    
    <span class="comment">// if we made it this far, the password was correct</span>
    <span class="storage type">const</span> userToken <span class="keyword operator">=</span> jwt.<span class="function call">sign</span>({
        id: user._id
    }, process.env.SECRET_KEY);
    
    <span class="comment">// note that the response object allows chained calls to cookie and json</span>
    res
        .<span class="function call">cookie</span>(<span class="string">"usertoken"</span>, userToken, secret, {
            httpOnly: <span class="constant language">true</span>
        })
        .<span class="function call">json</span>({ msg: <span class="string">"success!"</span> });
}
</pre>
                            </div>
                            <p>We will try and see if the user exists via the <code>User.findOne</code>.
                                If the user does exist, we will use <code>bcrypt</code> to compare the hashed password
                                in the database to the plaintext one supplied.
                                If they match, then we can create a jwt and send it in a cookie.</p>
                            <h2>Updating Register Method</h2>
                            <p>We can now update the register method with some additional logic.
                                Once the user is successfully registered, we can log them in immediately as an added
                                convenience.</p>
                                <div class="highlight">
                                    <div class="clipboard"><button class="btn btn-clipboard blankkk"
                                            aria-label="Clipboard button"></button></div>
<pre data-language="javascript">...
register: (req, res) <span class="storage type function arrow">=&gt;</span> {
    User.<span class="function call">create</span>(req.body)
    .<span class="function call">then</span>(user <span class="storage type function arrow">=&gt;</span> {
        <span class="storage type">const</span> userToken <span class="keyword operator">=</span> jwt.<span class="function call">sign</span>({
            id: user._id
        }, process.env.SECRET_KEY);
    
        res
            .<span class="function call">cookie</span>(<span class="string">"usertoken"</span>, userToken, secret, {
                httpOnly: <span class="constant language">true</span>
            })
            .<span class="function call">json</span>({ msg: <span class="string">"success!"</span>, user: user });
    })
    .<span class="keyword">catch</span>(err <span class="storage type function arrow">=&gt;</span> res.<span class="function call">json</span>(err));
}
...
</pre>
                                </div>
                            <h2>Logout</h2>
                            <p>Logging out is as simple as clearing the usertoken cookie. See the following example:</p>
                            <div class="highlight">
                                <div class="clipboard"><button class="btn btn-clipboard blankkk"
                                        aria-label="Clipboard button"></button></div>
<pre data-language="javascript">...
logout: (req, res) <span class="storage type function arrow">=&gt;</span> {
    res.<span class="function call">clearCookie</span>(<span class="string">'usertoken'</span>);
    res.<span class="function call">sendStatus</span>(<span class="constant numeric">200</span>);
}
...
</pre>
                            </div>
                            <h2>The Front-end and Credentials</h2>
                            <p>Have you ever tried accessing a website that asks you to log in before seeing anything?
                                That's because the website wants to ensure you are authorized to see its content.
                                Whenever we wish to send credentials, such as cookies and authorization headers (more on
                                those in the next module), from one origin to another, we must include the
                                withCredentials property in our request.</p>
                            <p>Our HTTP request objects have a withCredentials property set to False by default -
                                meaning our cookies and authorization headers will not be able to travel from origin to
                                origin or location to location. In our local environment, this is from the request
                                originating in our client running on Port 3000 to our API located on our local machine's
                                Port 8000.</p>
                            <p>Let's look at how that will affect the syntactical approach we must take with our
                                front-end post-request processes for registering, logging in, and logging out,
                                respectively.</p>
                            <h4>Register</h4>
                            <div class="highlight">
                                <div class="clipboard"><button class="btn btn-clipboard blankkk"
                                        aria-label="Clipboard button"></button></div>
<pre
    data-language="javascript">axios.<span class="function call">post</span>(<span class="string">'http://localhost:8000/api/register'</span>, payload, {withCredentials: <span class="constant language">true</span>})
</pre>
                            </div>
                            <h4>Login</h4>
                            <div class="highlight">
                                <div class="clipboard"><button class="btn btn-clipboard blankkk"
                                        aria-label="Clipboard button"></button></div>
<pre
    data-language="javascript">axios.<span class="function call">post</span>(<span class="string">'http://localhost:8000/api/login'</span>, payload, {withCredentials: <span class="constant language">true</span>})
</pre>
                            </div>
                            <h4>Logout</h4>
                            <div class="highlight">
                                <div class="clipboard"><button class="btn btn-clipboard blankkk"
                                        aria-label="Clipboard button"></button></div>
<pre data-language="javascript">axios.<span class="function call">post</span>(<span class="string">'http://localhost:8000/api/logout'</span>, {}, {withCredentials: <span class="constant language">true</span>})
</pre>
                            </div>
                        </div>
                        <br><br><br>



                        <div class="d-flex justify-content-between " id="navigation">
                            <a href="../MERN Auth/asyncawait.html" class="previous_page">&laquo;
                                Previous</a>
                            <a href="../MERN Auth/AuthorizationandMiddleware.html" class="next_page ">Next
                                &raquo;</a>

                        </div>











                    </main>
                </div>
            </div>
        </div>
    </div>




    <!-- Include jQuery and Bootstrap JS (CDN) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <script src="/assets/js/color-modes.js"></script>
    <script src="/assets/js/search.js"></script>
    <script src="/assets/js/main.js"></script>


    <!-- <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/prism.min.js"></script>
  <script>
    Prism.highlightAll();
  </script> -->



    <script>
        // Initialize Prism.js
        Prism.highlightAll();
    </script>

</body>

</html>